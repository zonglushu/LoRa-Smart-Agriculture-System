# LoRa 智慧农业系统 🌾

## 简介 📘

LoRa 智慧农业系统是一个基于 Spring Boot，EMQ，Vue3 和微信小程序开发的物联网信息管理平台。它提供设备操作、位置跟踪和环境数据采集等基本功能，同时支持传感器接入、外接设备控制和定制数据大屏等扩展功能。

针对 MySQL 与 Redis 数据不一致问题，系统采用 RabbitMQ 异步删除缓存，解耦数据库操作与缓存管理。使用模板方法模式结合策略模式简化和增强不同硬件传感器场景的地址访问灵活性，提高系统的可维护性。

门面模式用于简化通信流程，而 Cglib 代理和代理模式用于解析和处理来自硬件的数据包，确保根据硬件反馈正确访问数据库表。

为了实现远距离通信，系统实现了自定义 IO 密集型线程池和任务队列，以支持传感器控制的并发执行和异步化，允许即时响应前端请求，并支持更多任务排队而不导致系统过载。

## 概述

LoRa 智慧农业系统是一个基于 Spring Boot 框架构建的 Java 应用程序。它利用 MyBatis 进行 ORM，并包含各种用于 Web 开发的实用工具。

## 特性 ✨

- **统一环境监测视图**: 整合多源异构传感器数据，生成统一的环境监测界面。
- **设备自动化引擎**: 提出并实现设备自动化引擎的构想，以类似插件化的方式满足多数异构物联网设备的集成，确保不同设备之间的无缝交互性。
- **Schema 编码器和解码器**: 开发基于 JSON 的标准化数据 Schema 及其对应的编码器和解码器。
- **指令解释单元**: 设计自动化引擎的关键组件，包括指令解释、代理工厂和自适应代码生成器，以实现基于硬件配置指令自动生成软件逻辑处理单元。
- **Spring Boot**: 提供用于构建 Java 应用程序的强大框架。
- **MyBatis**: 促进数据库交互，具有类似 ORM 的方法。
- **Web 开发**: 包括用于构建 Web 应用程序的 Spring Boot Starter Web。
- **AOP**: 支持使用 Spring Boot Starter AOP 进行面向切面的编程。
- **实用工具**: 使用 Apache Commons Lang 提供额外的 Java 实用工具。

## 项目结构

- **`src/main/java`**: 包含主要的 Java 源代码。
- **`src/main/resources`**: 包括配置文件和资源映射。
  - **application.yml**: 主要配置文件。
  - **`mapper`**: MyBatis 映射的 XML 文件。
  - **`static`** 和 **`templates`**: Web 资源。
- **`src/test/java`**: 包含测试用例。

## 先决条件

- Java 1.8
- Maven

## 安装 🛠️

1. 确保您已安装 Java 1.8 和 Maven。
2. 克隆仓库：
   ```bash
   git clone <repository-url>
   ```
3. 导航到项目目录：
   ```bash
   cd lora
   ```
4. 使用 Maven 构建项目：
   ```bash
   ./mvnw clean install
   ```

## 使用 🚀

1. 运行应用程序：
   ```bash
   ./mvnw spring-boot:run
   ```
2. 在 `http://localhost:8080` 访问应用程序。

## 配置 ⚙️

- 修改 `src/main/resources` 中的 `application.yml` 文件以配置应用程序设置。

## 架构 🏗️

LoRa 智慧农业系统的架构围绕网关-节点-module 线展开，其中 module 负责数据处理。这种设置允许高效的数据处理和各种物联网设备的集成。

![架构图](doc/images/architecture-diagram-zh.png)

- **MQTTReq 生成中心**: 负责创建发送给硬件的消息对象。
- **MQTT 消息发送中心**: 发送消息到 MQTT 服务器。
- **MQTT 消息接收中心**: 从 MQTT 服务器接收消息。
- **消息分配中心**: 将 JSON 消息分配给适当的处理程序。
- **Redis**: 作为消息存储中心，存储所有消息。
- **Service 分配中心**: 根据 MQTTRes 对象分配服务。
- **代理工厂**: 动态生成所需的服务代理。
- **前端处理**: 处理具体的数据库任务并与前端接口。

上述架构图展示了数据流动和这些组件之间的交互，提供了系统结构和功能的清晰概览。

## API 文档 📑

有关详细的 API 文档，请参阅 [API 文档](docs/api.md)。

## 贡献 🤝

欢迎贡献！请 fork 仓库并提交 pull 请求。以下是贡献指南：

- 请确保您的代码符合项目的编码标准。
- 请提供详细的提交消息和注释。
- 请确保您的 pull 请求包含必要的测试用例。

## 许可证 📄

此项目根据 MIT 许可证授权。
